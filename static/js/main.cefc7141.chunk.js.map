{"version":3,"sources":["redux/fileReducer.ts","mocks/quarter-circle.ts","redux/reducers.ts","store.ts","components/TargetBox.tsx","components/FileUploader.tsx","redux/fileActions.ts","redux/fileSelectors.ts","components/FileContent.tsx","lib/gCodeCalculator.ts","lib/gCodeHelpers.ts","lib/mathUtils.ts","components/Statistics.tsx","components/GithubRibbon.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["initialState","fileContent","combineReducers","file","state","arguments","length","undefined","action","type","payload","createStore","rootReducer","window","__REDUX_DEVTOOLS_EXTENSION__","style","border","padding","justifyContent","display","alignItems","DropTarget","props","accepts","drop","monitor","onDrop","connect","connectDropTarget","dropTarget","isOver","canDrop","_ref","isActive","react_default","a","createElement","index_esm","icon","CloudDownload","inputStyle","FileUploader","_React$Component","_getPrototypeOf2","_this","Object","classCallCheck","this","_len","args","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","concat","fileInputRef","React","createRef","onFileChange","event","files","currentTarget","storeContent","onButtonClick","current","click","onResetClick","resetFile","handleFileDrop","_item","getItem","inherits","createClass","key","value","_this2","fileReader","FileReader","readAsText","onload","updateFileContent","result","toString","className","ref","onChange","components_TargetBox","NativeTypes","FILE","Button","color","onClick","Component","fileContentSelector","FileContent","Input","rows","trim","name","id","INCH_TO_MM","sanitizeCoordinate","val","Decimal","mul","toNumber","sanitizePoint","modal","point","units","x","y","z","getArcCurveLength","startVector","endVector","fixedVector","clockwise","radius","Line3","distance","startAngle","Math","atan2","endAngle","ArcCurve","getLength","getLineLength","groupByMotion","distances","reduce","acc","line","previous","motion","objectSpread","defineProperty","add","getStatistics","gCode","values","_getPaths","lines","curves","Toolpath","addLine","start","end","push","startPoint","endPoint","addArcCurve","fixed","fixedPoint","loadFromStringSync","getPaths","linesDistances","map","Vector3","curvesDistances","curve","linesDistance","curvesDistance","totalDistance","toConsumableArray","MM_DISPLAY_PRECISION","formatDistance","toLocaleString","maximumFractionDigits","minimumFractionDigits","infos","G0","G1","G2","G3","renderDistances","keys","info","title","Statistics","statistics","Fragment","Table","striped","bordered","size","rel","target","href","position","top","right","GithubRibbon","src","alt","App","es","store","cjs","backend","HTML5Backend","Container","Row","Col","components_FileUploader","components_FileContent","components_Statistics","Boolean","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.cefc7141.chunk.js","sourcesContent":["import { FileAction } from './fileActions'\nimport { gCode } from '../mocks/quarter-circle'\n\nexport type State = {\n  fileContent: string\n}\n\nconst initialState: State = {\n  fileContent: gCode\n}\n\nexport function fileReducer(\n  state: State = initialState,\n  action: FileAction\n): State {\n  switch (action.type) {\n    case 'UPDATE_FILE_CONTENT':\n      const { fileContent } = action.payload\n      return {\n        fileContent\n      }\n\n    case 'RESET_FILE': {\n      return {\n        fileContent: ''\n      }\n    }\n\n    default:\n      return state\n  }\n}\n","export const gCode = `\nG21\nG00 X0 Y0 F70\nG01 Z-1 F50\nG01 X0 Y5 F50\nG02 X5 Y0 J-5\nG01 X0 Y0\nG00 Z0 F70\nM30\n`\n","import { combineReducers } from 'redux'\n\nimport { fileReducer, State } from './fileReducer'\n\nexport type AppState = {\n  file: State\n}\n\nexport default combineReducers({ file: fileReducer })\n","import { createStore } from 'redux'\nimport rootReducer from './redux/reducers'\n\nexport default createStore(\n  rootReducer,\n  // @ts-ignore\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n)\n","import React from 'react'\nimport {\n  DropTarget,\n  DropTargetConnector,\n  ConnectDropTarget,\n  DropTargetMonitor\n} from 'react-dnd'\nimport Octicon, { CloudDownload } from '@githubprimer/octicons-react'\n\nconst style: React.CSSProperties = {\n  border: '1px solid gray',\n  padding: '2rem',\n  justifyContent: 'center',\n  display: 'flex',\n  alignItems: 'center'\n}\n\nexport interface TargetBoxProps {\n  accepts: string[]\n  onDrop: (props: TargetBoxProps, monitor: DropTargetMonitor) => void\n  isOver: boolean\n  canDrop: boolean\n  connectDropTarget: ConnectDropTarget\n}\n\nconst TargetBox: React.FC<TargetBoxProps> = ({\n  canDrop,\n  isOver,\n  connectDropTarget\n}) => {\n  const isActive = canDrop && isOver\n  return connectDropTarget(\n    <div style={style}>\n      <Octicon icon={CloudDownload} />\n      {isActive ? 'Release to drop' : 'Drag file here'}\n    </div>\n  )\n}\n\nexport default DropTarget(\n  (props: TargetBoxProps) => props.accepts,\n  {\n    drop(props: TargetBoxProps, monitor: DropTargetMonitor) {\n      if (props.onDrop) {\n        props.onDrop(props, monitor)\n      }\n    }\n  },\n  (connect: DropTargetConnector, monitor: DropTargetMonitor) => ({\n    connectDropTarget: connect.dropTarget(),\n    isOver: monitor.isOver(),\n    canDrop: monitor.canDrop()\n  })\n)(TargetBox)\n","import React from 'react'\nimport { connect } from 'react-redux'\nimport { NativeTypes } from 'react-dnd-html5-backend'\nimport { DropTargetMonitor } from 'react-dnd'\n\nimport { updateFileContent, resetFile } from '../redux/fileActions'\nimport TargetBox from './TargetBox'\nimport { Button } from 'reactstrap'\n\ntype Props = {\n  resetFile: typeof resetFile\n  updateFileContent: typeof updateFileContent\n}\n\nconst inputStyle: React.CSSProperties = {\n  display: 'none'\n}\n\nexport class FileUploader extends React.Component<Props> {\n  fileInputRef: React.RefObject<HTMLInputElement> = React.createRef()\n\n  onFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { files } = event.currentTarget\n    this.storeContent(files)\n  }\n\n  onButtonClick = () => {\n    if (this.fileInputRef.current) {\n      this.fileInputRef.current.click()\n    }\n  }\n\n  onResetClick = () => {\n    this.props.resetFile()\n  }\n\n  handleFileDrop = (_item: any, monitor: DropTargetMonitor) => {\n    if (monitor) {\n      this.storeContent(monitor.getItem().files)\n    }\n  }\n\n  storeContent(files: FileList | null) {\n    if (files && files[0]) {\n      const file = files[0]\n      const fileReader = new FileReader()\n      fileReader.readAsText(file)\n      fileReader.onload = () => {\n        this.props.updateFileContent(\n          fileReader.result ? fileReader.result.toString() : ''\n        )\n      }\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"file-uploader\">\n        <input\n          style={inputStyle}\n          ref={this.fileInputRef}\n          type=\"file\"\n          onChange={this.onFileChange}\n        />\n        <TargetBox onDrop={this.handleFileDrop} accepts={[NativeTypes.FILE]} />\n        <div className=\"buttons d-flex justify-content-between\">\n          <Button color=\"warning\" onClick={this.onResetClick}>\n            Reset\n          </Button>\n          <Button color=\"primary\" onClick={this.onButtonClick}>\n            Select file\n          </Button>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  null,\n  {\n    updateFileContent,\n    resetFile\n  }\n)(FileUploader)\n","type UpdateFileContentAction = {\n  type: 'UPDATE_FILE_CONTENT'\n  payload: {\n    fileContent: string\n  }\n}\n\ntype ResetFileAction = {\n  type: 'RESET_FILE'\n}\n\nexport function updateFileContent(\n  fileContent: string\n): UpdateFileContentAction {\n  return {\n    type: 'UPDATE_FILE_CONTENT',\n    payload: {\n      fileContent\n    }\n  }\n}\n\nexport function resetFile(): ResetFileAction {\n  return {\n    type: 'RESET_FILE'\n  }\n}\n\nexport type FileAction = UpdateFileContentAction | ResetFileAction\n","import { AppState } from './reducers'\n\nexport function fileContentSelector(state: AppState) {\n  return {\n    fileContent: state.file.fileContent\n  }\n}\n","import React from 'react'\nimport { connect } from 'react-redux'\nimport { Input } from 'reactstrap'\n\nimport { fileContentSelector } from '../redux/fileSelectors'\n\ntype Props = {\n  fileContent: string\n}\n\nexport class FileContent extends React.Component<Props> {\n  onChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    // TODO\n  }\n\n  render() {\n    return (\n      <Input\n        rows={20}\n        value={this.props.fileContent.trim()}\n        type=\"textarea\"\n        name=\"text\"\n        id=\"file-content\"\n        onChange={this.onChange}\n      />\n    )\n  }\n}\n\nexport default connect(\n  fileContentSelector,\n  {}\n)(FileContent)\n","// @ts-ignore no typings\nimport Toolpath from 'gcode-toolpath'\nimport Decimal from 'decimal.js'\nimport { Line3, Vector3, ArcCurve } from 'three'\n\nimport { Modal, Point, Line, Curve } from './gCodeTypes'\nimport { unitsAreInches, isClockwise } from './gCodeHelpers'\nimport { sum } from './mathUtils'\n\nconst INCH_TO_MM = 25.4\n\nfunction sanitizeCoordinate(val: number) {\n  return new Decimal(val).mul(INCH_TO_MM).toNumber()\n}\n\nfunction sanitizePoint(modal: Modal, point: Point) {\n  if (!unitsAreInches(modal.units)) {\n    return point\n  }\n  return {\n    x: sanitizeCoordinate(point.x),\n    y: sanitizeCoordinate(point.y),\n    z: sanitizeCoordinate(point.z)\n  }\n}\n\nfunction getPaths(gCode: string) {\n  const lines: Array<Line> = []\n  const curves: Array<Curve> = []\n  const toolpath = new Toolpath({\n    addLine: (modal: Modal, start: Point, end: Point) => {\n      lines.push({\n        modal,\n        startPoint: sanitizePoint(modal, start),\n        endPoint: sanitizePoint(modal, end)\n      })\n    },\n    addArcCurve: (modal: Modal, start: Point, end: Point, fixed: Point) => {\n      curves.push({\n        modal,\n        startPoint: sanitizePoint(modal, start),\n        endPoint: sanitizePoint(modal, end),\n        fixedPoint: sanitizePoint(modal, fixed)\n      })\n    }\n  })\n  toolpath.loadFromStringSync(gCode)\n  return { lines, curves }\n}\n\nexport type MotionDistanceMap = {\n  [motion: string]: Decimal\n}\n\nexport type Statistics = {\n  linesDistance: MotionDistanceMap\n  curvesDistance: MotionDistanceMap\n  totalDistance: Decimal\n}\n\nexport function getArcCurveLength(\n  startVector: Vector3,\n  endVector: Vector3,\n  fixedVector: Vector3,\n  clockwise: boolean\n) {\n  const radius = new Line3(startVector, fixedVector).distance()\n  const startAngle = Math.atan2(\n    startVector.y - fixedVector.y,\n    startVector.x - fixedVector.x\n  )\n  const endAngle = Math.atan2(\n    endVector.y - fixedVector.y,\n    endVector.x - fixedVector.x\n  )\n  return new ArcCurve(\n    fixedVector.x,\n    fixedVector.y,\n    radius,\n    startAngle,\n    endAngle,\n    clockwise\n  ).getLength()\n}\n\nexport function getLineLength(startVector: Vector3, endVector: Vector3) {\n  return new Line3(startVector, endVector).distance()\n}\n\nfunction groupByMotion(\n  distances: Array<{ modal: Modal; length: number }>\n): { [motion: string]: Decimal } {\n  return distances.reduce((acc: MotionDistanceMap, line) => {\n    const previous = acc[line.modal.motion] || new Decimal(0)\n    return {\n      ...acc,\n      [line.modal.motion]: previous.add(line.length)\n    }\n  }, {})\n}\n\nexport function getStatistics(gCode: string): Statistics {\n  const { lines, curves } = getPaths(gCode)\n\n  const linesDistances = lines.map(line => {\n    const { startPoint, endPoint, modal } = line\n    const startVector = new Vector3(startPoint.x, startPoint.y, startPoint.z)\n    const endVector = new Vector3(endPoint.x, endPoint.y, endPoint.z)\n    return {\n      modal,\n      length: getLineLength(startVector, endVector)\n    }\n  })\n\n  const curvesDistances = curves.map(curve => {\n    const { startPoint, endPoint, fixedPoint, modal } = curve\n    const fixedVector = new Vector3(fixedPoint.x, fixedPoint.y, fixedPoint.z)\n    const startVector = new Vector3(startPoint.x, startPoint.y, startPoint.z)\n    const endVector = new Vector3(endPoint.x, endPoint.y, endPoint.z)\n\n    const clockwise = isClockwise(curve.modal.motion)\n    return {\n      modal,\n      length: getArcCurveLength(startVector, endVector, fixedVector, clockwise)\n    }\n  })\n  return {\n    linesDistance: groupByMotion(linesDistances),\n    curvesDistance: groupByMotion(curvesDistances),\n    totalDistance: sum([\n      ...linesDistances.map(line => line.length),\n      ...curvesDistances.map(curve => curve.length)\n    ])\n  }\n}\n","import { Units, Motion } from './gCodeTypes'\n\nexport function unitsAreInches(units: Units) {\n  return units === 'G20'\n}\n\nexport function isClockwise(motion: Motion) {\n  return motion === 'G2'\n}\n","import Decimal from 'decimal.js'\n\nexport function sum<T extends number | Decimal>(values: Array<T>) {\n  return values.reduce((acc, val) => acc.add(val), new Decimal(0))\n}\n","import React from 'react'\nimport { connect } from 'react-redux'\nimport { Table } from 'reactstrap'\nimport Decimal from 'decimal.js'\n\nimport { getStatistics, MotionDistanceMap } from '../lib/gCodeCalculator'\nimport { fileContentSelector } from '../redux/fileSelectors'\n\ntype Props = {\n  fileContent: string\n}\n\nconst MM_DISPLAY_PRECISION = 2\n\nfunction formatDistance(distance: Decimal) {\n  return distance.toNumber().toLocaleString(undefined, {\n    maximumFractionDigits: MM_DISPLAY_PRECISION,\n    minimumFractionDigits: MM_DISPLAY_PRECISION\n  })\n}\n\nconst infos: { [motion: string]: string } = {\n  G0: 'Rapid positioning - move mode',\n  G1: 'Linear interpolation - work mode',\n  G2: 'Circular interpolation, clockwise - work mode',\n  G3: 'Circular interpolation, counterclockwise - work mode'\n}\n\nfunction renderDistances(distances: MotionDistanceMap) {\n  return Object.keys(distances).map(motion => {\n    const info = infos[motion]\n    return (\n      <tr key={motion}>\n        <td>{info ? <abbr title={info}>{motion}</abbr> : motion}</td>\n        <td className=\"text-right\">{formatDistance(distances[motion])}</td>\n      </tr>\n    )\n  })\n}\n\nexport class Statistics extends React.Component<Props> {\n  render() {\n    const { fileContent } = this.props\n    const statistics = getStatistics(fileContent)\n    return (\n      <>\n        <Table striped bordered size=\"sm\">\n          <thead>\n            <tr>\n              <th>Motion</th>\n              <th className=\"text-right\">Distance (mm)</th>\n            </tr>\n          </thead>\n          <tbody>\n            {renderDistances(statistics.linesDistance)}\n            {renderDistances(statistics.curvesDistance)}\n            <tr className=\"font-weight-bold\">\n              <td>Total</td>\n              <td className=\"text-right\">\n                {formatDistance(statistics.totalDistance)}\n              </td>\n            </tr>\n          </tbody>\n        </Table>\n        <p>\n          More info about G code here:&nbsp;\n          <a\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n            href=\"https://en.wikipedia.org/wiki/G-code#List_of_G-codes_commonly_found_on_FANUC_and_similarly_designed_controls_for_milling_and_turning\"\n          >\n            https://en.wikipedia.org/wiki/G-code#List_of_G-codes_commonly_found_on_FANUC_and_similarly_designed_controls_for_milling_and_turning\n          </a>\n        </p>\n      </>\n    )\n  }\n}\n\nexport default connect(fileContentSelector)(Statistics)\n","import React from 'react'\n\nconst style: React.CSSProperties = {\n  position: 'absolute',\n  top: 0,\n  right: 0,\n  border: 0\n}\n\nexport function GithubRibbon() {\n  return (\n    <a href=\"https://github.com/vojty/g-code-analyzer\">\n      <img\n        style={style}\n        src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png\"\n        alt=\"Fork me on GitHub\"\n      />\n    </a>\n  )\n}\n","import React from 'react'\nimport { Provider } from 'react-redux'\nimport { Container, Row, Col } from 'reactstrap'\nimport { DragDropContextProvider } from 'react-dnd'\nimport HTML5Backend from 'react-dnd-html5-backend'\n\nimport store from './store'\n\nimport './App.scss'\nimport 'bootstrap/dist/css/bootstrap.min.css'\n\nimport FileUploader from './components/FileUploader'\nimport FileContent from './components/FileContent'\nimport Statistics from './components/Statistics'\nimport { GithubRibbon } from './components/GithubRibbon'\n\nconst App: React.FC = () => {\n  return (\n    <Provider store={store}>\n      <DragDropContextProvider backend={HTML5Backend}>\n        <div className=\"App\">\n          <GithubRibbon />\n          <Container>\n            <Row>\n              <h1 className=\"display-1 mb-4\">G code analyzer</h1>\n            </Row>\n            <Row>\n              <Col>\n                <FileUploader />\n                <FileContent />\n              </Col>\n              <Col>\n                <Statistics />\n              </Col>\n            </Row>\n          </Container>\n        </div>\n      </DragDropContextProvider>\n    </Provider>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void\n  onUpdate?: (registration: ServiceWorkerRegistration) => void\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    )\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}